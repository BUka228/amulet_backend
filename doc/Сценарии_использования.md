# Сценарии использования Amulet (мобильные приложения и веб-админка)

## Роли
- Пользователь (владелец амулета)
- Партнёр (связанный пользователь для «объятий»)
- Администратор (контент, модерация, каталоги)

## Устройства и каналы
- Мобильное приложение iOS/Android
- Амулет (ESP32-C3, NFC, BLE, LRA, RGB, акселерометр)
- Зарядная подставка (Qi)
- Веб-админка (для контента и модерации)

## Онбординг и регистрация
1. Установка приложения с маркета.
2. Регистрация: по e-mail/паролю или OAuth (Apple/Google), согласие с политиками.
3. Подтверждение e-mail (по желанию), установка PIN/биометрии для быстрого входа.
4. Профиль: имя/ник, аватар, часовой пояс, язык, согласия на телеметрию.

## Сопряжение амулета
1. Пользователь подносит амулет к телефону (NFC-дииплинк в приложение).
2. Приложение мгновенно распознаёт устройство и показывает: «Обнаружен Амулет с серийным номером AMU-200-XYZ-001. Привязать к вашему аккаунту?». Выбор конкретного устройства не требуется.
3. При подтверждении включается Bluetooth (и при необходимости геолокация) для фоновой настройки BLE.
4. Привязка в облаке: создаётся пара «аккаунт ↔ устройство», выполняется верификация по одноразовому токену, переданному через NFC, и генерируются ключи сессии.
5. Тест: мигание, короткая вибрация. Сохранение имени и настроек устройства.

## Главный экран (Dashboard)
- Виджет статуса: заряд батареи, связь, активная практика/анимация.
- Быстрый старт популярной практики («Начать дыхание»).
- Статистика дня: минуты практик, «уровень спокойствия» (агрегаты).

## Библиотека практик
- Просмотр категорий: дыхание, медитации, звуковые ландшафты.
- Детали практики: описание, длительность, паттерн света/вибрации, аудио.
- Запуск практики: синхронизация со светом/вибрацией амулета, аудио на телефоне.
- Избранное, недавние, прогресс прохождения (для курсов).

## Дыхательные практики
- Выбор техники (квадратное, 4-7-8, сон, энергия).
- Старт/пауза/стоп, визуализация и тактильная синхронизация.
- Регулировка интенсивности вибрации/яркости, сохранение пресета.

## Медитации
- Плейлисты и курсы, трекинг прогресса.
- Фоновая пульсация амулета, управление громкостью, напоминания.

## Звуковые ландшафты
- Выбор сцены (дождь, костёр, космос).
- Проигрывание на телефоне, соответствующее свечение на амулете.

## Социальная связь («Объятия»)
- Приглашение партнёра по ссылке/QR, подтверждение связи.
- Настройка палитры эмоций: цвет + паттерн вибрации/света.
- Отправка «объятия»: выбор эмоции, мгновенная доставка на амулет партнёра.
- Быстрый ответ: в приложении настраивается «Быстрый ответ на объятие» (цвет/паттерн по умолчанию). Двойной тап на амулете отправляет этот преднастроенный ответ.
- История отправленных/полученных, фильтры, реакции.

## Конструктор анимаций
- Создание пользовательских световых и вибро-паттернов.
- Превью на виртуальном аватаре и на реальном амулете.
- Сохранение в личной библиотеке, шаринг с партнёром.

### Детальный сценарий: Создание анимации
1. Пользователь открывает раздел "Конструктор анимаций" в приложении.
2. Выбор типа анимации из библиотеки шаблонов или создание с нуля.
3. Настройка параметров:
   - Для v1.0: цвет, яркость, скорость пульсации, длительность
   - Для v2.0: дополнительные параметры (направление, градиенты, бегущие огни)
4. Визуальный редактор с временной шкалой:
   - Drag-and-drop элементов анимации
   - Настройка последовательности и длительности каждого элемента
   - Комбинирование различных эффектов
5. Предварительный просмотр:
   - 3D-аватар показывает анимацию в реальном времени
   - Возможность тестирования на реальном устройстве
   - Сравнение с существующими паттернами
6. Сохранение и публикация:
   - Сохранение в личную библиотеку
   - Возможность сделать паттерн публичным
   - Поделиться с партнером через "объятия"
7. Отправка на амулет:
   - Автоматическое преобразование в команды для устройства
   - Поддержка различных форматов команд в зависимости от версии прошивки

### Сценарий: Адаптация под версию устройства
1. Приложение определяет HARDWARE_VERSION устройства при подключении.
2. Для v1.0 (один светодиод):
   - Показываются только совместимые эффекты
   - Упрощенный интерфейс конструктора
   - Ограниченные возможности (пульсация, переливы, мерцание)
3. Для v2.0 (кольцо светодиодов):
   - Полный функционал конструктора
   - Сложные анимации (бегущие огни, градиенты, анимации по кольцу)
   - Расширенные настройки направления и последовательности

### Сценарий: Синхронизация паттернов
1. Пользователь создает анимацию на одном устройстве.
2. Паттерн автоматически синхронизируется с облаком.
3. На других устройствах пользователя паттерн становится доступен.
4. При отправке "объятия" с пользовательским паттерном:
   - Паттерн передается партнеру
   - Если у партнера другая версия устройства, паттерн адаптируется
   - Партнер может сохранить паттерн в свою библиотеку

## Управление уведомлениями
- Включение/выключение по приложениям/контактам.
- Назначение реакции (цвет/паттерн) на тип события.
- Тихие часы, режим «Не беспокоить», расписания.

## Интеграции и сценарии (Control Center)
- Графический конструктор «ЕСЛИ → ТО» (IFTTT-подобный).
- Триггеры: дабл-тап/лонг-тап, календарь, погода, гео-ивенты, вебхуки, биометрические показатели (v3.0).
- Действия: запуск практики, подсветка, уведомление партнёру, умный дом.
- Пример: «ЕСЛИ прогноз на завтра — дождь, ТО подсветить амулет синим вечером».
 - Пример (биометрия, v3.0): «ЕСЛИ мой уровень HRV падает ниже 20, ТО запустить 1‑минутную дыхательную практику ‘Экстренная помощь’».

## Ежедневное использование
- Утро: цвет под погодный прогноз.
- День: 2-минутное дыхание при стрессе, быстрые жесты.
- Вечер: получено «объятие» от близкого; ответ двойным тапом.
- Сон: 10-мин медитация, плавная пульсация, автозавершение.
 - Обновление «по воздуху»: приложение уведомляет о новой прошивке с улучшенными анимациями. Вы нажимаете «Обновить», кладёте амулет на стол — он сам скачивает и устанавливает обновление, пока вы пьёте кофе.

## Статистика и аналитика
- Дневные/недельные/месячные отчёты: время практик, частота «объятий».
- Индекс практики (уровень вовлечённости): на основе регулярности и длительности практик. Метрика «спокойствия» доступна только при наличии биометрии.
- Награды, streaks, мягкая геймификация.

## Настройки устройства
- Имя устройства, прошивка, обновления OTA.
- Яркость, интенсивность вибрации, жесты (одиночное/двойное/удержание).
- Сброс к заводским, отвязка от аккаунта, передача другому пользователю.

## Безопасность и приватность
- Контроль шаринга данных, отзыв разрешений, экспорт/удаление аккаунта.
- Шифрование трафика, защита связки пользователей, анти-спам «объятий».

## Админка
- Управление контентом: практики, аудио, паттерны, категории, локализации.
- Модерация пользовательских паттернов (если шарятся публично).
- Каталог устройств: серийники, статусы, замены, отзыв.
- Поддержка: тикеты, логи событий, действия модератора.
